generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "mysql"
}

model canal {
  id                BigInt    @id @default(autoincrement())
  id_sucursal       BigInt?
  tipo              String?   @db.Text
  numero_telefonico String?   @db.Text
  sucursal          sucursal? @relation(fields: [id_sucursal], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "canales_ibfk_1")

  @@index([id_sucursal], map: "id_sucursal")
}

model lead_prospectos {
  id          BigInt    @id @default(autoincrement())
  id_sucursal BigInt?
  nombre      String?   @db.Text
  telefono    String?   @db.Text
  fuente      String?   @db.Text
  etapa       String?   @db.Text
  sucursal    sucursal? @relation(fields: [id_sucursal], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "lead_prospectos_ibfk_1")
  mensaje     mensaje[]

  @@index([id_sucursal], map: "id_sucursal")
}

model mensaje {
  id              BigInt           @id @default(autoincrement())
  id_lead         BigInt?
  rol             String?          @db.Text
  contenido       String?          @db.Text
  tipo            mensaje_tipo?    @default(texto)
  fecha_envio     DateTime?        @default(now()) @db.DateTime(0)
  lead_prospectos lead_prospectos? @relation(fields: [id_lead], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "mensajes_ibfk_1")

  @@index([id_lead], map: "id_lead")
}

model prompt {
  id               BigInt             @id @default(autoincrement())
  id_sucursal      BigInt
  titulo           String?            @db.VarChar(255)
  prompt_final     String             @db.Text
  fecha_creacion   DateTime?          @default(now()) @db.DateTime(0)
  sucursal         sucursal           @relation(fields: [id_sucursal], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_prompt_sucursal1")
  prompt_atributos prompt_atributos[]

  @@index([id_sucursal], map: "fk_prompt_sucursal1_idx")
}

model prompt_atributos {
  id             BigInt  @id @default(autoincrement())
  id_prompt      BigInt
  clave_variable String? @db.VarChar(100)
  pregunta       String? @db.Text
  respuesta      String  @db.Text
  prompt         prompt  @relation(fields: [id_prompt], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "prompt_atributos_ibfk_1")

  @@index([id_prompt], map: "id_prompt")
}

model sucursal {
  id                 BigInt            @id @default(autoincrement())
  nombre_negocio     String?           @db.Text
  giro               String?           @db.Text
  ciudad             String?           @db.Text
  horarios           String?           @db.Text
  url_redes_sociales String?           @db.Text
  estado             String?           @db.VarChar(15)
  canal              canal[]
  lead_prospectos    lead_prospectos[]
  prompt             prompt[]
  usuario            usuario[]
}

model usuario {
  id             BigInt    @id @default(autoincrement())
  id_sucursal    BigInt?
  tipo           String?   @db.Text
  estado         String?   @db.Text
  email          String    @unique(map: "email") @db.VarChar(255)
  password_hash  String    @db.VarChar(255)
  fecha_creacion DateTime? @default(now()) @db.DateTime(0)
  sucursal       sucursal? @relation(fields: [id_sucursal], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "asistentes_ibfk_1")

  @@index([id_sucursal], map: "id_sucursal")
}

enum mensaje_tipo {
  texto
  imagen
  boton
  archivo
}
